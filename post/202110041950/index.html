<!DOCTYPE html><head><title>Tweak CPU Power Elegantly on Windows - kkocdko's blog</title><meta name="description" content="Using the powercfg"><script src="/bundle.js" onload="[].flat||(location='/update.html')"></script></head><main><article><h1>Tweak CPU Power Elegantly on Windows</h1><blockquote><p>KKOCDKO was watching movie on his laptop, but the fan system came into a start-stop cycle, which made him crazy: fan on &gt; cooling &gt; fan off &gt; heating &gt; fan on...</p></blockquote><p>Go to &quot;Control Panel &gt; Power Options &gt; Advanced Settings &gt; Processor Power Management&quot;, set &quot;Minimum processor state&quot; to <code>0%</code><sup>(1)</sup>, and the &quot;Maximum processor state&quot; is the point.</p><p>Set this value to <code>99%</code>, you can disable the boosting. To <code>0%</code>, make the frequency to lowest<sup>(2)</sup>. <strong>But it is troublesome to change the value by hand every time</strong>, so:</p><pre><code class="language-batch">@echo off
echo   [1] High   [2] Medium   [3] Low
choice /c 123 &gt;nul
if &quot;%errorLevel%&quot;==&quot;1&quot; set percent=100
if &quot;%errorLevel%&quot;==&quot;2&quot; set percent=99
if &quot;%errorLevel%&quot;==&quot;3&quot; set percent=0
powercfg /setacvalueindex SCHEME_BALANCED SUB_PROCESSOR PROCTHROTTLEMAX %percent%
powercfg /setdcvalueindex SCHEME_BALANCED SUB_PROCESSOR PROCTHROTTLEMAX %percent%
:: Make changes active
powercfg /s SCHEME_BALANCED
exit</code></pre><blockquote><p>(1) <a href="https://thegeekpage.com/power-management-tab-missing/">Parameter not showed?</a> or <a href="/./post/202110021131">Change Ineffective?</a></p><p>(2) Not the lowest, on my <code>R5-5600U</code>, its <code>1099 MHz</code>.</p><p>But why not Linux? Try <a href="https://wiki.archlinux.org/title/CPU_frequency_scaling#cpupower">cpupower</a>.</p></blockquote></article></main>