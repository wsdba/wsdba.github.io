<!DOCTYPE html><head><title>使用 VBA 批量转换 Office 文档格式 - kkocdko's blog</title><meta name="description" content="例如，转换 doc 到 docx"><script src="/bundle.js" onload="[].flat||(location='/update.html')"></script></head><main><article><h1>使用 VBA 批量转换 Office 文档格式</h1><pre><code class="language-vb">Sub FormatConverter()
Set instance = Documents &#39; 实例对象: Word=Documents | Excel=Workbooks | PowerPoint=Presentations
Const fromExt = &quot;doc&quot; &#39; 原始格式扩展名
Const toId = 12 &#39; 目标格式ID: doc=0 | docx=12 | xls=56 | xlsx=51 | ppt=1 | pptx=24
Set dialog = Application.FileDialog(msoFileDialogFilePicker)
dialog.Filters.Add fromExt, &quot;*.&quot; + fromExt, 1
dialog.Show
For Each item In dialog.SelectedItems
Set file = instance.Open(FileName:=item, ReadOnly:=True, Visible:=False)
file.SaveAs Left(item, InStrRev(item, &quot;.&quot;) - 1), toId
file.Close
Next
End Sub</code></pre><ul><li><p>新建文件，新建宏，替换为以上代码，参照注释修改，按键盘 <code>F5</code> 运行。</p></li><li><p>需要其他格式请参考 <code>FileFormat</code> 枚举（搜索关键词 <code>word format enum vba msdn</code>）。</p></li></ul><h2 id="change-log">Change Log</h2><h3 id="20210226">20210226</h3><ul><li>重构代码。</li></ul><h3 id="20180823">20180823</h3><ul><li><p>补充了适用于 Excel 的代码。</p></li><li><p>其他修改。</p></li></ul><h3 id="20180626">20180626</h3><ul><li>首个版本。</li></ul></article></main>