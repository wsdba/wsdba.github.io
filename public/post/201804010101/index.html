<!DOCTYPE html><head><title>让批处理以管理员权限运行 - kkocdko's blog</title><meta name="description" content="目前已知最好解决方案"><script src="/bundle.js" onload="[].flat||(location='/update.html')"></script></head><main><article><h1>让批处理以管理员权限运行</h1><pre><code class="language-batch">fltmc&gt;nul||mshta vbscript:CreateObject(&quot;Shell.Application&quot;).ShellExecute(&quot;%~dpnx0&quot;,&quot;%*&quot;,,&quot;runas&quot;,1)(window.close)&amp;&amp;exit</code></pre><ul><li><p>在<strong>开头</strong>添加这行代码，批处理就会在运行时申请提权。</p></li><li><p>无需写入临时文件。</p></li><li><p>有传入参数时也能得到管理员权限，且提权不会丢失参数。</p></li><li><p>在 <code>xp ~ 10</code> 上测试正常。不支持部分极限精简的 WinPE。</p></li></ul><h2 id="change-log">Change Log</h2><h3 id="20190524">20190524</h3><ul><li>修复只能传递第一个参数的 Bug。</li></ul><h3 id="20190221">20190221</h3><ul><li>一点改进，不切换当前目录。</li></ul><h3 id="20181109">20181109</h3><ul><li>一点改进，使得批处理被传参时也能提权。</li></ul><h3 id="20180401">20180401</h3><ul><li>首个版本。</li></ul></article></main>